<!DOCTYPE html>
<html>
<body>

<div id="input">
  <h3>Installation Guide</h3>

  <p>
    Please read the 
    <a href="https://example.com/docs">official documentation</a> 
    before proceeding.
  </p>

  <p>
    Visit our website at 
    <a href="https://example.com">https://example.com</a> 
    for more details.
  </p>

  <p>
    You can also check the 
    <a href="https://github.com/example/project">GitHub repository</a>.
  </p>

  <ol>
    <li>
      Download the installer from 
      <a href="https://example.com/download">this page</a>.
    </li>
    <li>
      Follow the setup instructions carefully.
    </li>
    <li>
      Contact 
      <a href="mailto:support@example.com">support@example.com</a> 
      if needed.
    </li>
  </ol>

  <p>
    This paragraph contains <b>bold text</b>, 
    <i>italic text</i>, and a 
    <a href="https://example.com/faq">FAQ link</a>.
  </p>
</div>

<br><br>
<button onclick="run()">Run Bookmarklet Logic</button>

<script>
function run() {
  const sel = window.getSelection();
  if (!sel.rangeCount || sel.isCollapsed) {
    alert("No selection!");
    return;
  }

  const range = sel.getRangeAt(0);
  const container = document.createElement("div");
  container.appendChild(range.cloneContents());

  // Convert links to: Link Text (URL)
  container.querySelectorAll("a").forEach(a => {
    const text = a.textContent.trim();
    const href = a.href;

    if (href) {
      const replacement = document.createTextNode(
        text ? `${text} (${href})` : href
      );
      a.replaceWith(replacement);
    }
  });

  // Extract plain text after link transformation
  const textOutput = container.innerText.trim();

  if (!textOutput) {
    alert("Selection has no text!");
    return;
  }

  navigator.clipboard.writeText(textOutput)
    .then(() => console.log("Selection text (with URLs) copied!"))
    .catch(err => alert("Copy failed: " + err));
}
</script>

</body>
</html>
